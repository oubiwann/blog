<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en" class="no-js"> <!--<![endif]-->
  
  
  
  <head profile="http://dublincore.org/documents/dcq-html/">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1179318-5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-1179318-5');
    </script>
    <meta charset="utf-8">
    <title>
    
      oubiwann | blog
      
      
      
    
    </title>
    

    
    
    
    <!-- General Metadata (site-wide) -->
    <meta name="description" content="A 21st century .plan for Duncan McGreggor">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="oubiwann | blog: version 5.0.0-SNAPSHOT, build ef95945

">

    <!-- Google Metadata -->
    <meta name="google-site-verification" content="w0pQqmlRRJk36_i3se1w2U7qwG8kS_VqiLS2hq5Wk7g" />

    <!-- Dublic Core Metadata (site-wide) -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/">
    <meta name="DC.format" scheme="DCTERMS.IMT" content="text/html">
    <meta name="DC.type" scheme="DCTERMS.DCMIType" content="Text">
    <meta name="DC.coverage" content="2003-2019">
    <meta name="DC.rights" content="Creative Commons Attribution-ShareAlike 4.0 International License">
    <meta name="DC.publisher" content="C&amp;B|Books">
    <meta name="DCTERMS.audience" content="Developers, Software Engineers, Computer Scientists, Technologists, Programmers, Programming Language Enthusiasts, Operational Engineers">

    
    
<!-- General Metadata (per-page) -->
<meta name="author" content="">

<!-- Dublic Core Metadata (per-page) -->
<meta name="DC.title" lang="en" content="LFE and rebar3">
<meta name="DC.creator" content="oubiwann">
<meta name="DC.subject" content="LFE">
<meta name="DC.date" content="2016-03-25">
<meta name="DC.identifier" scheme="DCTERMS.URI" content="https://oubiwann.github.io/blog/archives/2016-03/25-085808/lfe-and-rebar3.html">
<meta name="DCTERMS.abstract" content="">

<!-- Facebook's OpenGraph Metadata -->
<meta property="og:site_name" content="o|b">
<meta property="og:title" content="LFE and rebar3">
<meta property="og:url" content="https://oubiwann.github.io/blog/archives/2016-03/25-085808/lfe-and-rebar3.html">
<meta property="og:type" content="blog">
<meta property="og:description" content="">
<meta property="og:image" content="https://oubiwann.github.io/blog/img/ob-post-5.jpg">
<meta property="article:author" content="">
<meta property="article:published_time" content="2016-03-25 08:58:08">
<meta property="article:modified_time" content="">
<meta property="og:updated_time" content="">
<meta property="article:section" content="LFE">


<!-- Twitter Card Metadata -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site:id" content="@oubiwann">
<meta name="twitter:creator:id" content="@ErlangLisp">
<meta name="twitter:title" content="LFE and rebar3">
<meta name="twitter:url" content="https://oubiwann.github.io/blog/archives/2016-03/25-085808/lfe-and-rebar3.html">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://oubiwann.github.io/blog/img/ob-post-5.jpg">

    
    

    <link rel="alternate" type="application/atom+xml" title="Feed" href="/blog/atom.xml" />
    

    <!-- Webfonts Setup /-->
    <link href="https://fonts.googleapis.com/css?family=Maitree&amp;subset=latin-ext"
          rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Yantramanav&amp;subset=latin-ext"
          rel="stylesheet" type="text/css">

    <!-- Bootstrap/Custom Styles Setup /-->
    <link rel="stylesheet" href="/blog/assets/highlightjs/styles/arta.css" type="text/css">
    <link rel="stylesheet" href="/blog/assets/font-awesome/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/blog/assets/bootswatch/css/custom.min.css" rel="stylesheet" type="text/css" id="theme">
    <link rel="stylesheet" href="/blog/css/theme.css" rel="stylesheet" type="text/css" id="theme" media="screen">

    <!-- Favicon Setup /-->
    <link rel="apple-touch-icon" sizes="180x180" href="/blog/icons/apple-touch-icon.png?v=3">
    <link rel="icon" type="image/png" sizes="32x32" href="/blog/icons/favicon-32x32.png?v=3">
    <link rel="icon" type="image/png" sizes="16x16" href="/blog/icons/favicon-16x16.png?v=3">
    <link rel="manifest" href="/blog/icons/manifest.json?v=3">
    <link rel="mask-icon" href="/blog/icons/safari-pinned-tab.svg?v=3" color="#5bbad5">
    <link rel="shortcut icon" href="/blog/icons/favicon.ico?v=3">
    <meta name="apple-mobile-web-app-title" content="FRMX">
    <meta name="application-name" content="o|b">
    <meta name="msapplication-config" content="/blog/icons/browserconfig.xml?v=3">
    <meta name="theme-color" content="#ffffff">
    
    
    
    
    
  

  </head>
  
  <body>
  
   
    <header class="tiny">
      
<div class="navbar navbar-expand-lg fixed-top navbar-light bg-light">
  <div class="container">
    <div class="navbar-brand-wrapper">
      <a href="/blog/" class="navbar-brand">o|b</a>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

   <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/blog/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/archives">Archives</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/categories">Categories</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/tags">Tags</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/authors">Authors</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="about">About <span class="caret"></span></a>
          <div class="dropdown-menu" aria-labelledby="about">
            <a class="dropdown-item" href="/blog/about/">The Blog</a>
            <a class="dropdown-item" href="/blog/about/contact/">Contact Us</a>
            <a class="dropdown-item" href="/blog/about/powered-by/">Powered By</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="/blog/about/license/">License</a>
          </div>
        </li>
      </ul>

      <ul class="nav navbar-nav ml-auto social-nav">
        <li class="nav-item">
          <a href="/blog/atom.xml" alt="Atom Feed">
            <i class="fa fa-feed first"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="https://twitter.com/oubiwann" alt="Twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="/googleplus" alt="Google+">
            <i class="fa fa-google-plus"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="http://github.com/oubiwann" alt="Github">
            <i class="fa fa-github"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="https://groups.google.com/forum/#!forum/oubiwann-blog-new-posts"
             alt="Email Notifications">
            <i class="fa fa-envelope"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

    </header>
    
    
    <main id="main-content">
      

    <!-- Page Content -->
    <div class="container page-content">

      <div class="row">

        <!-- Post Content Column -->
        <div class="col-lg-12">

          <!-- Title -->
          <h1 class="mt-4">LFE and rebar3</h1>

          <!-- Author -->
          <p class="lead">
            Posted on March 25,
            2016 by
            <a href="/blog/authors#oubiwann">oubiwann</a>
          </p>

          <ul class="nav nav-tabs">
            <li class="nav-item">
              <a class="nav-link show active" data-toggle="tab" href="#content">Content</a>
            </li>
            <li class="nav-item">
              <a class="nav-link show" data-toggle="tab" href="#metadata">Metadata</a>
            </li>
          </ul>

          <br/>

          <div id="post-content" class="tab-content">
            <div class="tab-pane fade active show" id="content">

          <!-- Post Image -->
          <img class="card-img-top" src="/blog/img/ob-post-5.jpg" alt="Blog post image">

          <hr>

          <!-- Post Content -->
          <p><a href="/assets/images/posts/lfe-rebar3-logo.png"><img class="left thumb" src="{{ site.base_url }}/assets/images/posts/lfe-rebar3-logo.png" /></a> This post provides a quick introduction to using ``rebar3`` in LFE projects or in Erlang+LFE projects. After this quick read, you'll be able to jump right in to LFE development in projects managed with ``rebar3`` :-) <br /> <br /></p><p>With the support of namespaces landing in ``rebar3`` last year, the LFE community started making slow but steady progress toward adopting ``rebar3`` as its preferred tool for building projects, running tests, creating releases, examining dependency trees, generating docs, and creating generally useful, project-oriented command-line tools.</p><p>As a community, we've still got a ways to go before we completely reproduce all the functionality that has been provided by ``lfetool``, but every new LFE plugin brings us closer to that goal.</p><p>Note that this post assumes that you already have Erlang installed on your system.</p><h2>Installing ``rebar3``</h2><p>There are several ways to get ``rebar3`` (including building it yourself), but most of us use the readily available option provided on the project's <a href='https://github.com/erlang/rebar3'>README</a>:</p><pre><code class="bash">$ wget https://s3.amazonaws.com/rebar3/rebar3 &amp;&amp; chmod +x rebar3
$ sudo mv rebar3 /usr/local/bin
</code></pre><p>This is the nightly build. I have been very happy with the nightlies and have used them consistently in both development and production without any issues. If you'd like to read more about installing ``rebar3``, be sure to check out the <a href='http://www.rebar3.org/docs/getting-started'>getting started page</a>.</p><h2>Compiling LFE Files</h2><p>With ``rebar3`` installed, you're ready to rock and roll: bringing LFE into an Erlang project is as simple as updating your ``rebar.config`` file. (Note that if you are moving from ``rebar`` to ``rebar3``, it is indeed a <em>move</em>: for the most part, ``rebar3`` configuration options are not backwards compatible with ``rebar``).</p><p>If you've got an Erlang project and you want to support adding LFE files to it, here's all you need to do to the project's ``rebar.config``:</p><pre><code class="erlang">{plugins, &#91;
   {'lfe-compile',
     {git, &quot;https://github.com/lfe-rebar3/compile.git&quot;, {tag, &quot;0.3.0&quot;}}}
  &#93;}.

{provider&#95;hooks, &#91;{pre, &#91;{compile, {lfe, compile}}&#93;}&#93;}.
</code></pre><p>Then, add ``.lfe`` source files to your heart's content. When done, simply compile:</p><pre><code class="bash">$ rebar3 compile
</code></pre><p>This will pull down all the dependencies that the LFE-rebar3 plugin has (including LFE itself), compile all your ``.erl`` files that ``rebar3`` normally does, and then compile any ``.lfe`` files you have added.</p><p>Note that if you only want to (re-)compile ``.lfe`` files, you may explicitly call the plugin's compile command:</p><pre><code class="bash">$ rebar3 lfe compile
</code></pre><p>If your project is LFE-only (no ``.erl`` files), the set up is exactly the same.</p><h2>Bringing in LFE Libraries</h2><p>If you'd like to add some of the [community LFE libraries](https://github.com/lfex) to your project, or pull in libraries from somewhere else, simply add them to the ``deps`` section in the ``rebar.config``. Here's how you add the LFE library which allows you to use some Clojure idioms in your LFE code (e.g., the ``->`` and ``->>`` thrushing macros):</p><pre><code class="erlang">{deps, &#91;
   {clj, &quot;.&#42;&quot;, {git, &quot;git://github.com/lfex/clj.git&quot;, {tag, &quot;0.4.0&quot;}}}
  &#93;}.
</code></pre><p>Running ``rebar3 compile`` again will pull down this library and all of its dependencies, making all of their modules and include files available for use in your LFE code. (Note that if you want to use the thrushing macros, you'll need to put ``(include-lib "clj/include/compose.lfe")`` after your ``defmodule``.)</p><h2>LFE Plugins</h2><p>The LFE compile plugin is written in Erlang. However, all the other LFE-rebar3 plugins currently under development are written in LFE itself. There are a few <a href='https://github.com/lfe-rebar3'>small utility plugins</a> that we've been experimenting with, but perhaps the most useful plugin right now is the <a href='https://github.com/lfe-rebar3/lodox'>lodox</a> documentation-generator (inspired by Clojure's <a href='https://github.com/weavejester/codox'>Codox</a>).</p><p>If you'd like to use this plugin, simply add it to your other ``rebar3`` plugins:</p><pre><code class="erlang">{plugins, &#91;
   {'lfe-compile',
     {git, &quot;https://github.com/lfe-rebar3/compile.git&quot;, {tag, &quot;0.3.0&quot;}}},
   {lodox,
     {git, &quot;https://github.com/lfe-rebar3/lodox.git&quot;, {tag, &quot;0.12.10&quot;}}}
  &#93;}.
</code></pre><p>And then you are ready to use it to generate HTML docs for your LFE source code:</p><pre><code class="bash">$ rebar3 lfe lodox
</code></pre><h2>``rebar3`` Features</h2><p>``rebar3`` is a fantastic tool with a whole suite of incredibly useful features. If you run the following command:</p><pre><code class="bash">$ rebar3 --help
</code></pre><p>part of the output will show the standard commands that come with the tool (many of which also take their own subcommands; try out ``rebar new &ndash;help``):</p><pre><code>as                Higher order provider for running multiple tasks in ...
clean             Remove compiled beam files from apps.
compile           Compile apps .app.src and .erl files.
cover             Perform coverage analysis.
ct                Run Common Tests.
deps              List dependencies
dialyzer          Run the Dialyzer analyzer on the project.
do                Higher order provider for running multiple tasks in ...
edoc              Generate documentation using edoc.
escriptize        Generate escript archive.
eunit             Run EUnit Tests.
help              Display a list of tasks or help for a given task or subtask.
new               Create new project from templates.
path              Print paths to build dirs in current profile.
pkgs              List available packages.
release           Build release of project.
relup             Create relup of releases.
report            Provide a crash report to be sent to the rebar3 issues page.
shell             Run shell with project apps and deps in path.
tar               Tar archive of release built of project.
tree              Print dependency tree.
unlock            Unlock dependencies.
update            Update package index.
upgrade           Upgrade dependencies.
version           Print version for rebar and current Erlang.
xref              Run cross reference analysis.
</code></pre><p>Note that if you have a bunch of LFE plugins configured for use in your project, you'll also see those displayed as part of the output of ``rebar3 help``:</p><pre><code>lfe &lt;task&gt;:
  clean          The LFE rebar3 clean plugin.
  compile        The LFE rebar3 compiler plugin
  lodox          Generate documentation from LFE source files.
  repl           The LFE rebar3 LFE REPL plugin.
  test           The LFE rebar3 test plugin.
  version        The LFE rebar3 version plugin.
</code></pre><p>I've found the ``tree`` command quite helpful to track down explicit dependencies and their versions when debugging issues between projects:</p><pre><code class="bash">$ rebar3 tree
</code></pre><pre><code>===&gt; Verifying dependencies...
└─ lsci─0.0.2 &#40;project app&#41;
   ├─ encurses─0.4.1 &#40;git repo&#41;
   └─ py─0.0.5 &#40;git repo&#41;
      ├─ erlport─0.9.8 &#40;git repo&#41;
      ├─ logjam─0.4.0 &#40;git repo&#41;
      â  ├─ color─0.2.0 &#40;git repo&#41;
      â  ├─ lager─3.1.0 &#40;git repo&#41;
      â  â  └─ goldrush─0.1.8 &#40;git repo&#41;
      â  └─ lcfg─ &#40;git repo&#41;
      â     └─ ltest─0.8.0 &#40;git repo&#41;
      └─ lutil─0.8.0 &#40;git repo&#41;
         ├─ clj─0.4.0 &#40;git repo&#41;
         â  └─ kla─0.6.0 &#40;git repo&#41;
         └─ lfe─1.0 &#40;git repo&#41;
</code></pre><h2>Profiles</h2><p>This ``rebar3`` feature is important enough for its own section :-) You can read about ``rebar3`` profiles <a href='https://www.rebar3.org/docs/profiles'>here</a> but in short, they allow you to split up potentially very large ``rebar.config`` files into sections that will only get run if a particular profile is active.</p><p>Practically speaking, this means that you can do things like the following:</p><ul><li>allow your users to only download the minimum dependencies when compiling  your library</li><li>for example, only downloading and compiling the testing framework when  running tests, or</li><li>only downloading doc tools when running the "docs" profile</li><li>providing developer tools only run running the "dev" profile</li><li>set explicit dependencies on a per-profile basis</li><li>avoid some cyclic dependency issues</li></ul><p>This drastically reduced download and compile times for several of our more dependency-heavy libraries. [Here's an example](https://github.com/lfex/exemplar/blob/master/rebar.config) of an LFE project's ``rebar.config`` file making good use of the profiles feature. In that example, you can run the following commands to perform the per-profile actions:</p><p>Run the unit tests:</p><pre><code class="bash">$ rebar3 as test eunit
</code></pre><p>Get detailed version info:</p><pre><code class="bash">$ rebar3 as dev lfe version
</code></pre><p>Build the API reference for the project:</p><pre><code class="bash">$ rebar3 as docs lfe lodox
</code></pre><p>We've only just started using ``rebar3`` profiles in some of the LFE libraries, but we're already pretty big fans.</p><h2>Community Goals</h2><p>Our ultimate goal with rebar3 is to provide a suite of genuinely useful LFE plugins (written in LFE) that devs adore using. One of the things we've got slated for up-coming hack time is templates for LFE projects: not only providing LFE versions of the Erlang ones that ship with ``rebar3`` but also YAWS, elli, and LFE Dragon templates.</p>

            </div>
            <div class="tab-pane fade" id="metadata">

              <table class="table table-hover">
                <tbody>
                  <tr class="table-secondary">
                    <th scope="row">Author</th>
                    <td>oubiwann</td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Date</th>
                    <td>March 25,
        2016</td>
                  </tr>
                  <tr class="table-secondary">
                    <th scope="row">Time</th>
                    <td>08:58:08</td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Category</th>
                    <td>
                        <a href="/blog/categories/#LFE">LFE</a>
                    </td>
                  </tr>
                  <tr class="table-secondary">
                    <th scope="row">Tags</th>
                    <td>
                      
                      <a href="/blog/tags/#howto">howto</a>
                      
                      <a href="/blog/tags/#libraries">libraries</a>
                      
                      <a href="/blog/tags/#tools">tools</a>
                      
                      <a href="/blog/tags/#tutorials">tutorials</a>
                      
                      <a href="/blog/tags/#utilities">utilities</a>
                      
                    </td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Line&nbsp;Count</th>
                    <td>73 </td>
                  </tr>
                  <tr class="table-secondary">
                    <th scope="row">Word&nbsp;Count</th>
                    <td>1245 </td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Character&nbsp;Count</th>
                    <td>10055 </td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <hr>

          <!-- Comments Note -->
          <div class="card my-4">
            <h5 class="card-header">Comments?</h5>
            <div class="card-body">
              This blog doesn't use standard (embedded) comments; however, since
              the site is hosted on Github, if there <emphasis>is</emphasis>
              something you'd like to share, please do so by
              <a href="https://github.com/oubiwann/blog/issues/new">opening a
              "comment" ticket!</a>
            </div>
          </div>

        </div>

      </div>
      <!-- /.row -->

    </div>
    <!-- /.container -->

<!-- End main page content -->

    </main>
    
    
    <footer id="footer">
      
        <div class="row">
          <div class="col-lg-6">

            <ul class="list-unstyled">
              <li class="text-muted">Blogs</li>
              <li><a href="http://oubiwann.blogspot.com">Electric Duncan</a></li>
              <li><a href="http://blog.lfe.io/">LFE Blog</a></li>
              <li><a href="http://clojang.lfe.io/">Clojang</a></li>
              <li><a href="https://clozhang.github.io/blog/">Clozhang</a></li>
            </ul>

          </div>
          <div class="col-lg-6">
            <ul class="list-unstyled">
              <li class="float-lg-right text-muted">Github orgs</li>
              <li class="float-lg-right"><a href="https://github.com/erlsci">erlsci</a></li>
              <li class="float-lg-right"><a href="https://github.com/lfex">lfex</a></li>
              <li class="float-lg-right"><a href="https://github.com/clozhang">clozhang</a></li>
              <li class="float-lg-right"><a href="https://github.com/clojang">clojang</a></li>
              <li class="float-lg-right"><a href="https://github.com/clojusc">clojusc</a></li>
              <li class="float-lg-right"><a href="https://github.com/hexagram30">hexagram30</a></li>
            </ul>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-6">
          </div>
          <div class="col-lg-6">
            <ul class="list-unstyled">

              <li class="float-lg-right"><a href="https://github.com/masteringmatplotlib">masteringmatplotlib</a></li>
              <li class="float-lg-right"><a href="https://github.com/usgs-lcmap">usgs-lcmap</a></li>
              <li class="float-lg-right"><a href="https://github.com/nasa-ngap-archives">nasa-ngap-archives</a></li>
              <li class="float-lg-right"><a href="https://github.com/nasa-cmr-archives">nasa-cmr-archives</a></li>

            </ul>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <p><a href="http://creativecommons.org/licenses/by-sa/4.0/">
              <img src="https://licensebuttons.net/l/by-sa/4.0/88x31.png">
            </a></p>
            <p class="text-muted">Content released under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License.</a>.</p>
            <p class="text-muted">Copyright &copy; Duncan McGreggor, 2003-2019</p>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <p class="text-muted">Design adapted from the Bootswatch
              <a href="https://bootswatch.com/darkly/">Darkly</a> theme.
            </p>
          </div>
        </div>


    </footer>
    
    
    <script src="/blog/assets/jquery/dist/jquery.min.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/popper.js/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/bootstrap/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/bootswatch/js/custom.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/highlightjs/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
  
  </body>
</html>
