<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en" class="no-js"> <!--<![endif]-->
  
  
  
  <head profile="http://dublincore.org/documents/dcq-html/">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1179318-5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-1179318-5');
    </script>
    <meta charset="utf-8">
    <title>
    
      oubiwann | blog
      
      
      
    
    </title>
    

    
    
    
    <!-- General Metadata (site-wide) -->
    <meta name="description" content="A 21st century .plan for Duncan McGreggor">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="oubiwann | blog: version 5.0.0-SNAPSHOT, build 8cf312a

">

    <!-- Google Metadata -->
    <meta name="google-site-verification" content="w0pQqmlRRJk36_i3se1w2U7qwG8kS_VqiLS2hq5Wk7g" />

    <!-- Dublic Core Metadata (site-wide) -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/">
    <meta name="DC.format" scheme="DCTERMS.IMT" content="text/html">
    <meta name="DC.type" scheme="DCTERMS.DCMIType" content="Text">
    <meta name="DC.coverage" content="2003-2019">
    <meta name="DC.rights" content="Creative Commons Attribution-ShareAlike 4.0 International License">
    <meta name="DC.publisher" content="C&amp;B|Books">
    <meta name="DCTERMS.audience" content="Developers, Software Engineers, Computer Scientists, Technologists, Programmers, Programming Language Enthusiasts, Operational Engineers">

    
    
<!-- General Metadata (per-page) -->
<meta name="author" content="">

<!-- Dublic Core Metadata (per-page) -->
<meta name="DC.title" lang="en" content="lutil 0.5.0: Composition, Predicates and Core lutil">
<meta name="DC.creator" content="oubiwann">
<meta name="DC.subject" content="LFE">
<meta name="DC.date" content="2014-12-14">
<meta name="DC.identifier" scheme="DCTERMS.URI" content="https://oubiwann.github.io/blog/archives/2014-12/14-164508/lutil-0-5-0-composition-predicates-and-core-lutil.html">
<meta name="DCTERMS.abstract" content="New features in lutil 0.4.1">

<!-- Facebook's OpenGraph Metadata -->
<meta property="og:site_name" content="o|b">
<meta property="og:title" content="lutil 0.5.0: Composition, Predicates and Core lutil">
<meta property="og:url" content="https://oubiwann.github.io/blog/archives/2014-12/14-164508/lutil-0-5-0-composition-predicates-and-core-lutil.html">
<meta property="og:type" content="blog">
<meta property="og:description" content="New features in lutil 0.4.1">
<meta property="og:image" content="https://oubiwann.github.io/blog/img/ob-post-1.jpg">
<meta property="article:author" content="">
<meta property="article:published_time" content="2014-12-14 16:45:08">
<meta property="article:modified_time" content="">
<meta property="og:updated_time" content="">
<meta property="article:section" content="LFE">


<!-- Twitter Card Metadata -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site:id" content="@oubiwann">
<meta name="twitter:creator:id" content="@ErlangLisp">
<meta name="twitter:title" content="lutil 0.5.0: Composition, Predicates and Core lutil">
<meta name="twitter:url" content="https://oubiwann.github.io/blog/archives/2014-12/14-164508/lutil-0-5-0-composition-predicates-and-core-lutil.html">
<meta name="twitter:description" content="<p><p><a href="{{ site.base<i>url }}/assets/images/posts/lutil-leonardo-gears-large.png"><img class="right thumb" src="{{ site.base</i>url }}/assets/images/posts/lutil-leonardo-gears.png" /></a>With the <a href='https://github.com/lfex/lutil/releases/tag/0.5.0'>release of lutil 0.5.0</a>, there are new "compose" functions accompanying the <a href='https://github.com/lfex/lutil/commits/master/include/compose-macros.lfe?author=dysinger'>previously-merged</a> ...</p>">
<meta name="twitter:image" content="https://oubiwann.github.io/blog/img/ob-post-1.jpg">

    
    

    <link rel="alternate" type="application/atom+xml" title="Feed" href="/blog/atom.xml" />
    

    <!-- Webfonts Setup /-->
    <link href="https://fonts.googleapis.com/css?family=Maitree&amp;subset=latin-ext"
          rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Yantramanav&amp;subset=latin-ext"
          rel="stylesheet" type="text/css">

    <!-- Bootstrap/Custom Styles Setup /-->
    <link rel="stylesheet" href="/blog/assets/highlightjs/styles/arta.css" type="text/css">
    <link rel="stylesheet" href="/blog/assets/font-awesome/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/blog/assets/bootswatch/css/custom.min.css" rel="stylesheet" type="text/css" id="theme">
    <link rel="stylesheet" href="/blog/css/theme.css" rel="stylesheet" type="text/css" id="theme" media="screen">

    <!-- Favicon Setup /-->
    <link rel="apple-touch-icon" sizes="180x180" href="/blog/icons/apple-touch-icon.png?v=3">
    <link rel="icon" type="image/png" sizes="32x32" href="/blog/icons/favicon-32x32.png?v=3">
    <link rel="icon" type="image/png" sizes="16x16" href="/blog/icons/favicon-16x16.png?v=3">
    <link rel="manifest" href="/blog/icons/manifest.json?v=3">
    <link rel="mask-icon" href="/blog/icons/safari-pinned-tab.svg?v=3" color="#5bbad5">
    <link rel="shortcut icon" href="/blog/icons/favicon.ico?v=3">
    <meta name="apple-mobile-web-app-title" content="FRMX">
    <meta name="application-name" content="o|b">
    <meta name="msapplication-config" content="/blog/icons/browserconfig.xml?v=3">
    <meta name="theme-color" content="#ffffff">
    
    
    
    
    
  

  </head>
  
  <body>
  
   
    <header class="tiny">
      
<div class="navbar navbar-expand-lg fixed-top navbar-light bg-light">
  <div class="container">
    <div class="navbar-brand-wrapper">
      <a href="/blog/" class="navbar-brand">o|b</a>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

   <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/blog/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/archives">Archives</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/categories">Categories</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/tags">Tags</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/authors">Authors</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="about">About <span class="caret"></span></a>
          <div class="dropdown-menu" aria-labelledby="about">
            <a class="dropdown-item" href="/blog/about/">The Blog</a>
            <a class="dropdown-item" href="/blog/about/contact/">Contact Us</a>
            <a class="dropdown-item" href="/blog/about/powered-by/">Powered By</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="/blog/about/license/">License</a>
          </div>
        </li>
      </ul>

      <ul class="nav navbar-nav ml-auto social-nav">
        <li class="nav-item">
          <a href="/blog/atom.xml" alt="Atom Feed">
            <i class="fa fa-feed first"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="https://twitter.com/oubiwann" alt="Twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="/googleplus" alt="Google+">
            <i class="fa fa-google-plus"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="http://github.com/oubiwann" alt="Github">
            <i class="fa fa-github"></i>
          </a>
        </li>
        <li class="nav-item">
          <a href="https://groups.google.com/forum/#!forum/oubiwann-blog-new-posts"
             alt="Email Notifications">
            <i class="fa fa-envelope"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

    </header>
    
    
    <main id="main-content">
      

    <!-- Page Content -->
    <div class="container page-content">

      <div class="row">

        <!-- Post Content Column -->
        <div class="col-lg-12">

          <!-- Title -->
          <h1 class="mt-4">lutil 0.5.0: Composition, Predicates and Core lutil</h1>

          <!-- Author -->
          <p class="lead">
            Posted on December 14,
            2014 by
            <a href="/blog/authors#oubiwann">oubiwann</a>
          </p>

          <ul class="nav nav-tabs">
            <li class="nav-item">
              <a class="nav-link show active" data-toggle="tab" href="#content">Content</a>
            </li>
            <li class="nav-item">
              <a class="nav-link show" data-toggle="tab" href="#metadata">Metadata</a>
            </li>
          </ul>

          <br/>

          <div id="post-content" class="tab-content">
            <div class="tab-pane fade active show" id="content">

          <!-- Post Image -->
          <img class="card-img-top" src="/blog/img/ob-post-1.jpg" alt="Blog post image">

          <hr>

          <!-- Post Content -->
          <p><a href="{{ site.base<i>url }}/assets/images/posts/lutil-leonardo-gears-large.png"><img class="right thumb" src="{{ site.base</i>url }}/assets/images/posts/lutil-leonardo-gears.png" /></a>With the <a href='https://github.com/lfex/lutil/releases/tag/0.5.0'>release of lutil 0.5.0</a>, there are new "compose" functions accompanying the <a href='https://github.com/lfex/lutil/commits/master/include/compose-macros.lfe?author=dysinger'>previously-merged</a> thrushing macros as well as a new convenience include file which contains all of lutil's predicate functions defined for easy use in the REPL or in modules. Additionally there is a new, experimental include file that is beginning to define functions and macros considered "core" to the LFE experience but which aren't yet (and may never be) included in LFE-proper. Some of these may wrap Erlang functions with more options, others may provide new syntax, etc. See below for usage examples.</p><h2>Core Include File</h2><p>Be warned! This is for experimentation! Do not depend upon these functions remaining here in perpetuity.</p><p>This is a new include file while is the home for any functions that feel like they should be part of the language. They might wrap Erlang functions or provide basic functionality that's not in Erlang or LFE proper.</p><p>For now, it's just the following:</p><ul><li>``seq``</li><li>``range``</li><li>``next``</li><li>``take``</li></ul><h3>``seq`` Functions</h3><p>Let's start with pulling in the ``core`` include in the LFE REPL:</p><pre><code class="cl">&gt; &#40;include-lib &quot;lutil/include/core.lfe&quot;&#41;
loaded
</code></pre><p>Erlang doesn't have a ``lists:seq/1``, so we made one:</p><pre><code class="cl">&gt; &#40;seq 10&#41;
&#40;1 2 3 4 5 6 7 8 9 10&#41;
</code></pre><p>Having done that, we also provided wrappers for Erlang's ``lists:seq/2`` and ``lists:seq/3``.</p><p>As you can see, we opted for 1 as the default starting element. This follows in the tradition of many of Erlang's ``lists`` functions. 0-based sequences can just use ``seq/2``, e.g. ``(seq 0 10)``.</p><h3>``range`` Functions</h3><p>These functions were inspired by Clojure's <a href='https://github.com/clojure/clojure/blob/clojure-1.6.0/src/clj/clojure/core.clj#L2725'>range</a> function as well as <a href='https://docs.python.org/3/glossary.html#term-generator'>Python generators</a>. Our ``range`` provides us with the ability to generate an endless series of integers or floating point numbers without using more memory that what is required to create a few functions.</p><p>Unlike Python and Clojure, ``range`` is based upon Erlang's capacity for its own brand of lazy evaluation as demonstrated in <a href='http://erlangraymondtay.blogspot.com/2009/08/example-of-lazy-evaluation-for.html'>this blog post</a>. In particular, ``(range)`` returns a function (and so is more akin to Python's generators that Clojure's ``range`` function). When called, it will return a ``cons`` of:</p><ul><li>the next element of the defined series, and</li><li>another function, which will do the same as the previous function (but whose  first ``cons`` element is the next element in the series)</li></ul><p>Some example usage:</p><pre><code class="cl">&gt; &#40;range&#41;
#Fun&lt;lfe&#95;eval.23.86468545&gt;
&gt; &#40;funcall &#40;range&#41;&#41;
&#40;1 . #Fun&lt;lfe&#95;eval.23.86468545&gt;&#41;
&gt; &#40;funcall &#40;range 100&#41;&#41;
&#40;100 . #Fun&lt;lfe&#95;eval.23.86468545&gt;&#41;
</code></pre><p>The ``range`` function is actually a special case of the more general ``next`` function in lutil ``core``. More on that below.</p><p>lutil ``core`` defines the following:</p><ul><li>``range/0`` (default ``start`` of ``1`` and ``step`` of ``1``)<ul><li>``range/1`` - ``(range start)`` (default ``step`` of ``1``)</li><li>``range/2`` - ``(range start step)``</li></ul></li></ul><h3>``take`` Functions</h3><p>For ``range`` to be very useful, we need be able to pull values from it. Otherwise, we're left with usage like the following:</p><pre><code class="cl">&gt; &#40;funcall &#40;range&#41;&#41;
&#40;1 . #Fun&lt;lfe&#95;eval.23.86468545&gt;&#41;
&gt; &#40;funcall &#40;cdr &#40;funcall &#40;range&#41;&#41;&#41;&#41;
&#40;2 . #Fun&lt;lfe&#95;eval.23.86468545&gt;&#41;
&gt; &#40;funcall &#40;cdr &#40;funcall &#40;cdr &#40;funcall &#40;range&#41;&#41;&#41;&#41;&#41;&#41;
&#40;3 . #Fun&lt;lfe&#95;eval.23.86468545&gt;&#41;
&gt; &#40;funcall &#40;cdr &#40;funcall &#40;cdr &#40;funcall &#40;cdr &#40;funcall &#40;range&#41;&#41;&#41;&#41;&#41;&#41;&#41;&#41;
&#40;4 . #Fun&lt;lfe&#95;eval.23.86468545&gt;&#41;
&gt;
</code></pre><p>That certainly has its own <em>peculiar</em> charm, but does not rate too highly in convenience. As such, a function like Clojure's ``take`` has been added to lutil ``core``. It does just what is says: takes a certain number of elements from our infinite series.</p><pre><code class="cl">&gt; &#40;take 4 &#40;range&#41;&#41;
&#40;1 2 3 4&#41;
</code></pre><p>Hej! That's much nicer than the above :-)</p><p>Sometimes one's code will be using both infinite series as well as definite lists and it would be nice to not have to change functions if the source of the data changes. As such, we've modified ``take`` to provide a wrapper for ``lists:sublist/2``:</p><pre><code class="cl">&gt; &#40;take 5 '&#40;1 2 3 4 5 6 7 8 9 10 11 12&#41;&#41;
&#40;1 2 3 4 5&#41;
</code></pre><p>Note that the ``take`` wrapper swaps the positions of the arguments so that it may be used with the ``->>`` macro. If you need to take from a list with the ``->`` macro, you will need to use ``lists:sublist/2``. (Be sure to see the section below for usage examples of ``->`` and ``->>``!)</p><p>We also added the following, as it ended up being useful:</p><pre><code class="cl">&gt; &#40;take 'all '&#40;1 2 3 4 5 6 7 8 9 10 11 12&#41;&#41;
&#40;1 2 3 4 5 6 7 8 9 10 11 12&#41;
</code></pre><p>One last point on ``take``: it is not based upon an element value, but rather the length of the accumulator. If you have use cases where you need to only take elements up to a certain value, let us know and we can generalize this further (also: patches welcome!).</p><h3>``next`` Functions</h3><p>Under the hood, the ``range`` function actually wraps the ``next`` function. ``next`` is a more general form that will repeatedly call a user-provided 2-arity function. In the case of ``range``, that function is addition.</p><p>For example, the following are identical:</p><pre><code class="cl">&gt; &#40;take 21 &#40;range&#41;&#41;
&#40;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21&#41;
&gt; &#40;take 21 &#40;next #'+/2 1 1&#41;&#41;
&#40;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21&#41;
&gt; &#40;take 21 &#40;next &#40;lambda &#40;x y&#41; &#40;+ x y&#41;&#41; 1 1&#41;&#41;
&#40;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21&#41;
</code></pre><p>You may use ``next`` directly to define your own infinite sequences. Here are a few examples:</p><pre><code class="cl">&gt; &#40;take 10 &#40;next &#40;lambda &#40;x y&#41; &#40;&#42; 3 &#40;+ x y&#41;&#41;&#41; 1 1&#41;&#41;
&#40;1 6 21 66 201 606 1821 5466 16401 49206&#41;
&gt; &#40;take 17 &#40;next &#40;lambda &#40;x &#95;&#41; &#40;&#42; 2 x&#41;&#41; 1 1&#41;&#41;
&#40;1 2 4 8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768 65536&#41;
&gt; &#40;take 7 &#40;next &#40;lambda &#40;x &#95;&#41; &#40;math:pow &#40;+ x 1&#41; 2&#41;&#41; 1 1&#41;&#41;
&#40;1 4.0 25.0 676.0 458329.0 210066388900.0 4.4127887745906175e22&#41;
</code></pre><h2>Predicates Include File</h2><p>This set of changes (and examples) is the most tame of the bunch. lutil has implemented several predicates of the form ``name?`` for the past while.</p><p>As projects have started to rely upon these more heavily, it seemed prudent to provide the increasingly-more-used predicates in include-form (thus alleviating developers having to use the full ``mod:fun`` syntax or from complicated and hard-to-maintain special imports).</p><p>Here's a quick way of seeing which predicates are supported:</p><pre><code class="cl">&gt; &#40;set before &#40;sets:from&#95;list &#40;lutil:get-env-funcs $ENV&#41;&#41;&#41;
#&#40;set 11 16 16 8 80 48
...&#41;
&gt; &#40;include-lib &quot;lutil/include/predicates.lfe&quot;&#41;
loaded
&gt; &#40;set after &#40;sets:from&#95;list &#40;lutil:get-env-funcs $ENV&#41;&#41;&#41;
#&#40;set 49 16 16 8 80 48
...&#41;
&gt; &#40;set loaded-funcs &#40;lists:sort
                      &#40;sets:to&#95;list
                        &#40;sets:subtract after before&#41;&#41;&#41;&#41;&#41;
...
</code></pre><p>Now we can see the functions available in our REPL environment that were brought in from ``include-lib``:</p><pre><code class="cl">&gt; &#40;lfe&#95;io:format &quot;&#126;p&#126;n&quot; &#40;list loaded-funcs&#41;&#41;
&#40;all? any? atom? binary? bitstring? bool? dict? element? empty? even?
 every? false? float? func? function? identical? in? int? integer?
 list? loaded neg? nil? not-any? not-in? number? odd? pos? record?
 reference? set? string? true? tuple? undef? undefined? unicode?
 zero?&#41;
ok
</code></pre><p>You can use the predicates include from the REPL or in modules with the usual ``include-lib`` call, as above.</p><p>Some example usage:</p><pre><code class="cl">&gt; &#40;zero? 0&#41;
true
&gt; &#40;zero? 1&#41;
false
&gt; &#40;all? #'even?/1 '&#40;2 4 6 8 9&#41;&#41;
false
&gt; &#40;all? #'even?/1 '&#40;2 4 6 8 10&#41;&#41;
true
</code></pre><h2>``compose`` Functions</h2><p>All of the 0.5.0 changes detailed above were actually yak-shavings in support of the ``compose`` functions. These new functions have been added as companions to the threshing macros (see below). These are similar to Clojure's ``compose`` function, but with some syntactic sugar to assist with the fact that LFE is a Lisp-2.</p><p>Pull in the functions:</p><pre><code class="cl">&gt; &#40;include-lib &quot;lutil/include/compose.lfe&quot;&#41;
loaded
</code></pre><p>Let's call ``compose/2`` on two math functions:</p><pre><code class="cl">&gt; &#40;funcall &#40;compose #'math:sin/1 #'math:asin/1&#41;
           0.5&#41;
0.49999999999999994
</code></pre><p>Now let's use ``compose/1`` on a list of functions:</p><pre><code class="cl">&gt; &#40;funcall &#40;compose `&#40;,#'math:sin/1
                      ,#'math:asin/1
                      ,&#40;lambda &#40;x&#41; &#40;+ x 1&#41;&#41;&#41;&#41;
           0.5&#41;
1.5
</code></pre><p>Here is compose being used in a filter:</p><pre><code class="cl">&gt; &#40;include-lib &quot;lutil/include/predicates.lfe&quot;&#41;
loaded
&gt; &#40;lists:filter &#40;compose #'not/1 #'zero?/1&#41;
                '&#40;0 1 0 2 0 3 0 4&#41;&#41;
&#40;1 2 3 4&#41;
</code></pre><p>Unlike schemes and Clojure, when calling ``compose`` directly, we can't just wrap parens around our function &ndash; we need to call ``funcall`` on it. But we can cheat, with a little help from Erlang arities :-)</p><p>The following are provided as conveniences when using compose by itself (in other words, not in a call to ``lists:map``, ``lists:filter``, a predicate, etc.):</p><pre><code class="cl">&gt; &#40;compose #'math:sin/1 #'math:asin/1 0.5&#41;
0.49999999999999994
&gt; &#40;compose `&#40;,#'math:sin/1
             ,#'math:asin/1
             ,&#40;lambda &#40;x&#41; &#40;+ x 1&#41;&#41;&#41;
           0.5&#41;
1.5
</code></pre><h2>Thrushing Macros</h2><p>And now we've reached dessert :-)</p><p>The following examples are for functionality that was previously added to lutil, authored originally by <a href='https://github.com/dysinger/lfesl/blob/master/include/thread.lfe'>Tim Dysinger</a>. Though not part of this release, these bonus usage examples are provided since it's such a cool set of macros, inspired by their Clojure analogs <a href='http://clojuredocs.org/clojure.core/-%3E'>-></a> and <a href='http://clojuredocs.org/clojure.core/-%3E%3E'>-> ></a>.</p><h3>The ``->`` Macro</h3><p>Reading (and sometimes writing) deeply nested functions can be a bit awkward:</p><pre><code class="cl">&gt; &#40;lists:sublist
    &#40;lists:reverse
      &#40;lists:sort
        &#40;lists:merge
          &#40;string:tokens
            &#40;string:to&#95;upper &quot;a b c d e&quot;&#41;
            &quot; &quot;&#41;
          '&#40;&quot;X&quot; &quot;F&quot; &quot;L&quot;&#41;&#41;&#41;&#41;
    2 3&#41;
&#40;&quot;L&quot; &quot;F&quot; &quot;E&quot;&#41;
</code></pre><p>This may seem like a contrived example (and well, yes, it is), but there are use cases where this comes up. In particular, the world of web application middleware where code is run between request and response one can get large stacks of nested functions.</p><p>Now grab the thrushing macros:</p><pre><code class="cl">&gt; &#40;include-lib &quot;lutil/include/compose.lfe&quot;&#41;
loaded
</code></pre><p>Here's how the first thrushing macro can help the previous example:</p><pre><code class="cl">&gt; &#40;-&gt; &quot;a b c d e&quot;
      &#40;string:to&#95;upper&#41;
      &#40;string:tokens &quot; &quot;&#41;
      &#40;lists:merge '&#40;&quot;X&quot; &quot;F&quot; &quot;L&quot;&#41;&#41;
      &#40;lists:sort&#41;
      &#40;lists:reverse&#41;
      &#40;lists:sublist 2 3&#41;&#41;
&#40;&quot;L&quot; &quot;F&quot; &quot;E&quot;&#41;
</code></pre><p>What's happening here is that the output from one function is passed as (inserted, really) the first argument in the next function.</p><p>The next macro does the opposite ...</p><h3>The ``->>`` Macro</h3><p>Let's get some includes:</p><pre><code class="cl">&gt; &#40;include-lib &quot;lutil/include/predicates.lfe&quot;&#41;
loaded
&gt; &#40;include-lib &quot;lutil/include/core.lfe&quot;&#41;
loaded
</code></pre><p>Next let's make a bunch of nested calls:</p><pre><code class="cl">&gt; &#40;lists:foldl #'+/2 0
    &#40;take 10
      &#40;lists:filter
        &#40;compose #'even?/1 #'round/1&#41;
        &#40;lists:map
          &#40;lambda &#40;x&#41;
            &#40;math:pow x 2&#41;&#41;
          &#40;seq 42&#41;&#41;&#41;&#41;&#41;
1540.0
</code></pre><p>Grab the thrushing macros:</p><pre><code class="cl">&gt; &#40;include-lib &quot;lutil/include/compose.lfe&quot;&#41;
loaded
</code></pre><p>And now let's rewrite the nested functions using the ``->>`` macro:</p><pre><code class="cl">&gt; &#40;-&gt;&gt; &#40;seq 42&#41;
       &#40;lists:map &#40;lambda &#40;x&#41; &#40;math:pow x 2&#41;&#41;&#41;
       &#40;lists:filter &#40;compose #'even?/1 #'round/1&#41;&#41;
       &#40;take 10&#41;
       &#40;lists:foldl #'+/2 0&#41;&#41;
1540.0
</code></pre><p>As promised, ``->>`` does the opposite of ``->`` in that the output from one function is <em>appended</em> to the arguments for the next call. In other words, the output of the previous call is the last argument in the next call.</p>

            </div>
            <div class="tab-pane fade" id="metadata">

              <table class="table table-hover">
                <tbody>
                  <tr class="table-secondary">
                    <th scope="row">Author</th>
                    <td>oubiwann</td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Date</th>
                    <td>December 14,
        2014</td>
                  </tr>
                  <tr class="table-secondary">
                    <th scope="row">Time</th>
                    <td>16:45:08</td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Category</th>
                    <td>
                        <a href="/blog/categories/#LFE">LFE</a>
                    </td>
                  </tr>
                  <tr class="table-secondary">
                    <th scope="row">Tags</th>
                    <td>
                      
                      <a href="/blog/tags/#announcements">announcements</a>
                      
                      <a href="/blog/tags/#libraries">libraries</a>
                      
                      <a href="/blog/tags/#releases">releases</a>
                      
                    </td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Line&nbsp;Count</th>
                    <td>128 </td>
                  </tr>
                  <tr class="table-secondary">
                    <th scope="row">Word&nbsp;Count</th>
                    <td>1718 </td>
                  </tr>
                  <tr class="table-light">
                    <th scope="row">Character&nbsp;Count</th>
                    <td>14631 </td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>

          <hr>

          <!-- Comments Note -->
          <div class="card my-4">
            <h5 class="card-header">Comments?</h5>
            <div class="card-body">
              This blog doesn't use standard (embedded) comments; however, since
              the site is hosted on Github, if there <emphasis>is</emphasis>
              something you'd like to share, please do so by
              <a href="https://github.com/oubiwann/blog/issues/new">opening a
              "comment" ticket!</a>
            </div>
          </div>

        </div>

      </div>
      <!-- /.row -->

    </div>
    <!-- /.container -->

<!-- End main page content -->

    </main>
    
    
    <footer id="footer">
      
        <div class="row">
          <div class="col-lg-6">

            <ul class="list-unstyled">
              <li class="text-muted">Blogs</li>
              <li><a href="http://oubiwann.blogspot.com">Electric Duncan</a></li>
              <li><a href="http://blog.lfe.io/">LFE Blog</a></li>
              <li><a href="http://clojang.lfe.io/">Clojang</a></li>
              <li><a href="https://clozhang.github.io/blog/">Clozhang</a></li>
            </ul>

          </div>
          <div class="col-lg-6">
            <ul class="list-unstyled">
              <li class="float-lg-right text-muted">Github orgs</li>
              <li class="float-lg-right"><a href="https://github.com/erlsci">erlsci</a></li>
              <li class="float-lg-right"><a href="https://github.com/lfex">lfex</a></li>
              <li class="float-lg-right"><a href="https://github.com/clozhang">clozhang</a></li>
              <li class="float-lg-right"><a href="https://github.com/clojang">clojang</a></li>
              <li class="float-lg-right"><a href="https://github.com/clojusc">clojusc</a></li>
              <li class="float-lg-right"><a href="https://github.com/hexagram30">hexagram30</a></li>
            </ul>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-6">
          </div>
          <div class="col-lg-6">
            <ul class="list-unstyled">

              <li class="float-lg-right"><a href="https://github.com/masteringmatplotlib">masteringmatplotlib</a></li>
              <li class="float-lg-right"><a href="https://github.com/usgs-lcmap">usgs-lcmap</a></li>
              <li class="float-lg-right"><a href="https://github.com/nasa-ngap-archives">nasa-ngap-archives</a></li>
              <li class="float-lg-right"><a href="https://github.com/nasa-cmr-archives">nasa-cmr-archives</a></li>

            </ul>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <p><a href="http://creativecommons.org/licenses/by-sa/4.0/">
              <img src="https://licensebuttons.net/l/by-sa/4.0/88x31.png">
            </a></p>
            <p class="text-muted">Content released under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License.</a>.</p>
            <p class="text-muted">Copyright &copy; Duncan McGreggor, 2003-2019</p>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <p class="text-muted">Design adapted from the Bootswatch
              <a href="https://bootswatch.com/darkly/">Darkly</a> theme.
            </p>
          </div>
        </div>


    </footer>
    
    
    <script src="/blog/assets/jquery/dist/jquery.min.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/popper.js/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/bootstrap/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/bootswatch/js/custom.js" crossorigin="anonymous"></script>
    <script src="/blog/assets/highlightjs/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
  
  </body>
</html>
